{
  "hash": "37b472c2de7b239c9cfdaaaef399d56a",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"input & output in Python\"\nauthor: \"Tony Duan\"\n\nexecute:\n  warning: false\n  error: false\nformat:\n  html:\n    toc: true\n    toc-location: right\n    code-fold: show\n    code-tools: true\n    number-sections: true\n    code-block-bg: true\n    code-block-border-left: \"#31BAE9\"\n---\n\nData input and ouput in python\n\n![](images/1_-OQi5hp-uoL_KdIydr4hew.gif){width=\"500\"}\n\n# input\n\n\n\n## read CSV\n\n::: {#4a61732a .cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\ndata=pd.read_csv('data/Book3.csv')\ndata\n```\n\n::: {.cell-output .cell-output-display execution_count=1}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>a</th>\n      <th>b</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1241</td>\n      <td>rhth</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>35235</td>\n      <td>rjyyj</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nread CSV online\n\n::: {#4227da42 .cell execution_count=2}\n``` {.python .cell-code}\nimport pandas as pd\nurl='https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-02-11/hotels.csv'\nhotels=pd.read_csv(url)\n```\n:::\n\n\n## read excel\n\nsheet_name=0 read first sheet.\n\nsheet_name=1 read second sheet.\n\n.sheet_name='Sheet1' read 'Sheet1' sheet.\n\n::: {#66ddab63 .cell execution_count=3}\n``` {.python .cell-code}\nimport pandas as pd\ndata_excel=pd.read_excel('data/Book1.xlsx',sheet_name=0)\ndata_excel\n```\n\n::: {.cell-output .cell-output-display execution_count=2}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>a</th>\n      <th>b</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1241</td>\n      <td>rhth</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>35235</td>\n      <td>rjyyj</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n## read parquet\n\nparquet format is one of the best for data analytic\n\n::: {#b46da09f .cell execution_count=4}\n``` {.python .cell-code}\ndata= pd.read_parquet(\"data/df.parquet\")\ndata.shape\n```\n\n::: {.cell-output .cell-output-display execution_count=3}\n```\n(100, 62)\n```\n:::\n:::\n\n\n::: {#d9afdd05 .cell execution_count=5}\n``` {.python .cell-code}\ndata.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=4}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>FlightDate</th>\n      <th>Airline</th>\n      <th>Origin</th>\n      <th>Dest</th>\n      <th>Cancelled</th>\n      <th>Diverted</th>\n      <th>CRSDepTime</th>\n      <th>DepTime</th>\n      <th>DepDelayMinutes</th>\n      <th>DepDelay</th>\n      <th>...</th>\n      <th>WheelsOn</th>\n      <th>TaxiIn</th>\n      <th>CRSArrTime</th>\n      <th>ArrDelay</th>\n      <th>ArrDel15</th>\n      <th>ArrivalDelayGroups</th>\n      <th>ArrTimeBlk</th>\n      <th>DistanceGroup</th>\n      <th>DivAirportLandings</th>\n      <th>__index_level_0__</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2022-04-04 00:00:00+00:00</td>\n      <td>Commutair Aka Champlain Enterprises, Inc.</td>\n      <td>GJT</td>\n      <td>DEN</td>\n      <td>False</td>\n      <td>False</td>\n      <td>1133</td>\n      <td>1123.0</td>\n      <td>0.0</td>\n      <td>-10.0</td>\n      <td>...</td>\n      <td>1220.0</td>\n      <td>8.0</td>\n      <td>1245</td>\n      <td>-17.0</td>\n      <td>0.0</td>\n      <td>-2.0</td>\n      <td>1200-1259</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2022-04-04 00:00:00+00:00</td>\n      <td>Commutair Aka Champlain Enterprises, Inc.</td>\n      <td>HRL</td>\n      <td>IAH</td>\n      <td>False</td>\n      <td>False</td>\n      <td>732</td>\n      <td>728.0</td>\n      <td>0.0</td>\n      <td>-4.0</td>\n      <td>...</td>\n      <td>839.0</td>\n      <td>9.0</td>\n      <td>849</td>\n      <td>-1.0</td>\n      <td>0.0</td>\n      <td>-1.0</td>\n      <td>0800-0859</td>\n      <td>2</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2022-04-04 00:00:00+00:00</td>\n      <td>Commutair Aka Champlain Enterprises, Inc.</td>\n      <td>DRO</td>\n      <td>DEN</td>\n      <td>False</td>\n      <td>False</td>\n      <td>1529</td>\n      <td>1514.0</td>\n      <td>0.0</td>\n      <td>-15.0</td>\n      <td>...</td>\n      <td>1622.0</td>\n      <td>14.0</td>\n      <td>1639</td>\n      <td>-3.0</td>\n      <td>0.0</td>\n      <td>-1.0</td>\n      <td>1600-1659</td>\n      <td>2</td>\n      <td>0</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>2022-04-04 00:00:00+00:00</td>\n      <td>Commutair Aka Champlain Enterprises, Inc.</td>\n      <td>IAH</td>\n      <td>GPT</td>\n      <td>False</td>\n      <td>False</td>\n      <td>1435</td>\n      <td>1430.0</td>\n      <td>0.0</td>\n      <td>-5.0</td>\n      <td>...</td>\n      <td>1543.0</td>\n      <td>4.0</td>\n      <td>1605</td>\n      <td>-18.0</td>\n      <td>0.0</td>\n      <td>-2.0</td>\n      <td>1600-1659</td>\n      <td>2</td>\n      <td>0</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>2022-04-04 00:00:00+00:00</td>\n      <td>Commutair Aka Champlain Enterprises, Inc.</td>\n      <td>DRO</td>\n      <td>DEN</td>\n      <td>False</td>\n      <td>False</td>\n      <td>1135</td>\n      <td>1135.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>...</td>\n      <td>1243.0</td>\n      <td>8.0</td>\n      <td>1245</td>\n      <td>6.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1200-1259</td>\n      <td>2</td>\n      <td>0</td>\n      <td>4</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows Ã— 62 columns</p>\n</div>\n```\n:::\n:::\n\n\nread parquet zip\n\n::: {#f3494645 .cell execution_count=6}\n``` {.python .cell-code}\ndata= pd.read_parquet(\"data/df.parquet.gzip\")\ndata.shape\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```\n(100, 62)\n```\n:::\n:::\n\n\n## read feather\n\n::: {#7f0bd01e .cell execution_count=7}\n``` {.python .cell-code}\ndata=pd.read_feather(\"data/feather_file.feather\")\ndata.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=6}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>FlightDate</th>\n      <th>Airline</th>\n      <th>Origin</th>\n      <th>Dest</th>\n      <th>Cancelled</th>\n      <th>Diverted</th>\n      <th>CRSDepTime</th>\n      <th>DepTime</th>\n      <th>DepDelayMinutes</th>\n      <th>DepDelay</th>\n      <th>...</th>\n      <th>WheelsOn</th>\n      <th>TaxiIn</th>\n      <th>CRSArrTime</th>\n      <th>ArrDelay</th>\n      <th>ArrDel15</th>\n      <th>ArrivalDelayGroups</th>\n      <th>ArrTimeBlk</th>\n      <th>DistanceGroup</th>\n      <th>DivAirportLandings</th>\n      <th>__index_level_0__</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2022-04-04 00:00:00+00:00</td>\n      <td>Commutair Aka Champlain Enterprises, Inc.</td>\n      <td>GJT</td>\n      <td>DEN</td>\n      <td>False</td>\n      <td>False</td>\n      <td>1133</td>\n      <td>1123.0</td>\n      <td>0.0</td>\n      <td>-10.0</td>\n      <td>...</td>\n      <td>1220.0</td>\n      <td>8.0</td>\n      <td>1245</td>\n      <td>-17.0</td>\n      <td>0.0</td>\n      <td>-2.0</td>\n      <td>1200-1259</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2022-04-04 00:00:00+00:00</td>\n      <td>Commutair Aka Champlain Enterprises, Inc.</td>\n      <td>HRL</td>\n      <td>IAH</td>\n      <td>False</td>\n      <td>False</td>\n      <td>732</td>\n      <td>728.0</td>\n      <td>0.0</td>\n      <td>-4.0</td>\n      <td>...</td>\n      <td>839.0</td>\n      <td>9.0</td>\n      <td>849</td>\n      <td>-1.0</td>\n      <td>0.0</td>\n      <td>-1.0</td>\n      <td>0800-0859</td>\n      <td>2</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2022-04-04 00:00:00+00:00</td>\n      <td>Commutair Aka Champlain Enterprises, Inc.</td>\n      <td>DRO</td>\n      <td>DEN</td>\n      <td>False</td>\n      <td>False</td>\n      <td>1529</td>\n      <td>1514.0</td>\n      <td>0.0</td>\n      <td>-15.0</td>\n      <td>...</td>\n      <td>1622.0</td>\n      <td>14.0</td>\n      <td>1639</td>\n      <td>-3.0</td>\n      <td>0.0</td>\n      <td>-1.0</td>\n      <td>1600-1659</td>\n      <td>2</td>\n      <td>0</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>2022-04-04 00:00:00+00:00</td>\n      <td>Commutair Aka Champlain Enterprises, Inc.</td>\n      <td>IAH</td>\n      <td>GPT</td>\n      <td>False</td>\n      <td>False</td>\n      <td>1435</td>\n      <td>1430.0</td>\n      <td>0.0</td>\n      <td>-5.0</td>\n      <td>...</td>\n      <td>1543.0</td>\n      <td>4.0</td>\n      <td>1605</td>\n      <td>-18.0</td>\n      <td>0.0</td>\n      <td>-2.0</td>\n      <td>1600-1659</td>\n      <td>2</td>\n      <td>0</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>2022-04-04 00:00:00+00:00</td>\n      <td>Commutair Aka Champlain Enterprises, Inc.</td>\n      <td>DRO</td>\n      <td>DEN</td>\n      <td>False</td>\n      <td>False</td>\n      <td>1135</td>\n      <td>1135.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>...</td>\n      <td>1243.0</td>\n      <td>8.0</td>\n      <td>1245</td>\n      <td>6.0</td>\n      <td>0.0</td>\n      <td>0.0</td>\n      <td>1200-1259</td>\n      <td>2</td>\n      <td>0</td>\n      <td>4</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows Ã— 62 columns</p>\n</div>\n```\n:::\n:::\n\n\n# outout\n\n## write CSV\n\n::: {#1d081f5e .cell execution_count=8}\n``` {.python .cell-code}\ndata.head().to_csv('data/out.csv', index=False)  \n```\n:::\n\n\n## write excel\n\n::: {#fca45bad .cell execution_count=9}\n``` {.python .cell-code}\ndata_excel.to_excel('data/out.xlsx')\n```\n:::\n\n\n## write parquet\n\n::: {#21629acd .cell execution_count=10}\n``` {.python .cell-code}\ndata.head(100).to_parquet('data/df.parquet') \n```\n:::\n\n\noutput to zip format\n\n::: {#f67cd7b3 .cell execution_count=11}\n``` {.python .cell-code}\ndata.head(100).to_parquet('data/df.parquet.gzip',\n              compression='gzip')  \n```\n:::\n\n\n## write feather\n\n::: {#9c6c41d5 .cell execution_count=12}\n``` {.python .cell-code}\ndata.head(100).to_feather(\"data/feather_file.feather\")\n```\n:::\n\n\n# Refernce\n\nhttps://medium.com/@gadhvirushiraj/the-best-file-format-for-data-science-ed756f937be8\n\n",
    "supporting": [
      "1 input output_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}